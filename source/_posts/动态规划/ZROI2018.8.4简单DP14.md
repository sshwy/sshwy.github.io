---
title: ZROI2018.8.4 简单 DP
categories:
  - 动态规划
mathjax: true
abbrlink: 30231
date: 2018-10-01 20:22:00
updated: 2018-10-01 20:22:00
---
总结暑假的DP小练习

# Exercise 1 

> 有一排 n 个电线杆,第 i 个的高度为 $h_i$ 。要在相邻的电线杆间造电线。每一根的代价是 $|h_i − h_{i+1}| \times C$。为一根电线杆增加 x 高度的代价是 $x^2$ ,最小化代价和。$n\le 10^5,\ h_i,C\le 100$.

暴力DP， $f[i,j]$ 表示前 i 个电线杆，其中第 i 个电线杆高度为 j 时的最小代价。

$$
f[i,j]=\min_{k\ge h_{i-1}}\{f[i-1,k]+|j-k|\cdot C+(j-h_i)^2\},j\ge h_i
$$

时间复杂度 $O(nC^2)$. 把绝对值拆开，变成两个决策集合：

$$
f[i,j]=\min_{h_{i-1}\le k\le j}\{f[i-1,k]-k\cdot C\}+(j-h_i)^2+j\cdot C\\
f[i,j]=\min_{k>j,k\ge h_{i-1}}\{f[i-1,k]+k\cdot C\}+(j-h_i)^2-j\cdot C
$$

前半部分可**预处理**前后缀的 $\min$，做到 $O(1)$ 查询。后半部分 $O(1)$ 计算。时间复杂度 $O(nC)$.

# Exercise 2

> 给出一个长度为 $n$ 的序列 $a$。对于每个 $a_i$ ,判断是否存在 $a_j \operatorname{and} a_i = 0$。$n\le 10^6,a_i\le 4\times 10^6$。

FWT解释成状圧。。。全靠~~口糊~~。

# Exercise 3

> 给出一张 $n$ 个点 $m$ 条边的图，求一个人从 $1$ 点出发经过所有点恰好一次的路径方案数。$n \le 10, m \le 1000$。

一个哈密尔顿通路。但是要注意这道题有重边。所以记录重边的数量变成简单图，这样在计数的时侯乘一下就行。

# Exercise 4

> 给出 $n$ 个子串,要求构造一个序列包含所有这 $n$ 个子串，求最小长度。$n\le 15,l_i\le 100$。

显然，序列一定以某个子串结尾。首先把包含关系的子串踢掉，然后$f[i,j]$表示序列以第i个子串结尾，匹配子串集合的状态是j的最小长度。转移的时侯暴力，后缀数组，hash都能干吧。

# Exercise 5

> 把 $n$ 个整数排成一列，问前缀和不出现给定的 $m$ 个数 $K_i$ 的方案数。$n\le 20$。

$f[i]$表示选择的数的集合状态是i的方案数。由于有了选择的状态，可以直接算总和，就能转移了。

# Exercise 6

CF895C

> 给出 $n$ 个数，问有多少个非空子集的乘积为完全平方数。$n \le 10^5,1 \le a_i \le 70$。

先来一个左队的方法吧。注意到$\sqrt{70}<9$，在9以内的质数只有2,3,5,7，于是我们把一个数分解质因数，用一个二元组$(S,x)$表示这个数。其中S表示2,3,5,7的次数的奇偶性。因为我们只关心能否形成完全平方数，因此关注奇偶性即可。而x表示剩下的大于$\sqrt{70}$的质因子。

显然我们想让x也出现奇数次，于是我们把二元组按x排序，这样就可以顺着DP了。假设有k个**不同**的x构成序列 $x_1,x_2\dots x_k$，那么思路大概是$f[i,j,S]$表示考虑前i个不同的x，其中$x_i$选择了j个，并且保证 $x_{1\sim i-1}$ 选择的次数是偶数次，并且2,3,5,7的状态为S的方案数。显然可以通过选择当前的二元组转移到$f[i,j+1,S']$。而 $\sum_j f[i,2j,S]$ 可以转移到$f[i+1,0,S]$。于是貌似在做的过程中可以不要j这一维，转移的时侯是 0D 的，所以复杂度大概是$O(n\cdot 2^4)$。

当然这道题也有线性基的做法，但本人太菜不会就不讲了

