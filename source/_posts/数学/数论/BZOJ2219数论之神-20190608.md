---
title: '[BZOJ2219] 数论之神'
mathjax: true
categories:
  - 数学
abbrlink: 42349
date: 2019-06-08 20:16:27
updated: 2019-06-12 11:52:27
tags: 同余, 原根, 离散对数, gcd
keywords:
---

**摘要**

啃课件的时侯遇到的，先放个题解，至于代码的话~~先咕着~~

<!--more-->

> 多组数据（<1000）对于给定的 3 个非负整数 A,B,K 求出满足> 1.  $X^A \equiv B(\bmod 2K + 1)$.
> 2.  X 在范围 [0, 2K] 内
> 
> 的 X 的个数.

即求同余方程 $x^a\equiv b\bmod P$ 的解的个数。$P=\prod_{i=1}^k{p_i}^{c_i}$. 则原方程的解即为 $x^a\equiv b\bmod {p_i}^{c_i}$ 的解的乘积（根据中国剩余定理）

问题变成求 
$$
x^a\equiv b\mod p^c
$$
的解的个数. 分类讨论如下

# Case1

如果 $(p^c,b)=p^c$，即 b 是 $p^c$ 的倍数，则原方程为 $x^a\equiv 0\mod p^c$.

显然 x 只可能是 p 的倍数，那么设 $x=p^tq,(p,q)=1$，则要求 $at\geq c$.

于是求得 $t_{min}=\left\lceil\frac{c}{a}\right\rceil$. 则 x 的最小值为 $x_{min}=p^{t_{min}}$，显然解的数量就是剩余系中 $x_{min}$ 的倍数，即 $\frac{p^c}{x_{min}}=p^{c-t_{min}}$.

# Case2

2019.6.12 来填坑啦

如果 $(p^c,b)=1$，即两者互质。

由于素数的幂一定有原根，因此可以将方程转化为离散对数方程。假设 $p^c$ 的一个原根是 r。
$$
x^a\equiv b\mod p^c\\ind_rx^a\equiv ind_rb \mod \varphi(p^c)\\
a\cdot ind_rx\equiv ind_rb \mod \varphi(p^c)\\
$$
记 $X=ind_rx,B=ind_rb,P=\varphi(p^c)$。那么可以利用 BSGS 求解 B，由于离散对数与原数一一对应，即 X 与 x 是一一对应的。因此原方程解的个数就等于离散对数方程的解的个数。
$$
aX\equiv B\mod P
$$
根据扩欧推论，若 $(a,P)|B$，那么方程有解，解的数量就是 (a,P)；否则无解。

# Case3

如果 $(p^c,b)>1$.

则可以记 $b=p^kq,(p,q)=1$. 方程变为 $x^a\equiv p^kq\mod p^c$。

显然，如果 $k\nmid a$，那么方程无解。根据同余方程的一些性质变化如下
$$
\left(\frac{x}{p^{\frac{k}{a}}}\right)^a\equiv q\mod p^{c-k}
$$
由于 (p,q)=1，这就转化为了 Case2. 

这样求完后，注意到 $x\in [0,p^c)$，因此 $x\cdot\left(p^{\frac{k}{a}}\right)^{-1}\in [0,p^{c-\frac{k}{a}})$. 但是上述方程中，$x\cdot\left(p^{\frac{k}{a}}\right)^{-1}\in [0,p^{c-k})$。因此最后要把求出的值乘上 $p^{k-\frac{k}{a}}$.