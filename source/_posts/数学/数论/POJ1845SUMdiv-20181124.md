---
title: '[POJ1845]Sumdiv'
tags:
 - 数论
 - 题解
categories:
  - 数学
mathjax: true
abbrlink: 10392
date: 2018-11-24 22:15:54
updated: 2018-11-24 22:15:54
---

# 分析

对 a 分解质因数：
$$
a=\prod_{i=1}^k{p_i}^{c_i}
$$
于是 a 的因数和表示为
$$
\sigma_a=\prod_{i=1}^{k}\left(\sum_{j=0}^{c_i}{p_i}^j\right)
$$
括号里是一个等比数列，公比为 $p_i$. 考虑递归求解等比数列
$$
\begin{split}
&f(p,c)=p^0+p^1+\cdots+p^c=\sum_{i=0}^{c}p^i\\
&f(p,c)=\left\{\begin{split}
&(1+p^\left\lceil\frac{c}{2}\right\rceil) f(p,\left\lfloor\frac{c}{2}\right\rfloor)&,c=2k+1,k\in Z\\
&1+p(1+p^\left\lceil\frac{c-1}{2}\right\rceil) f(p,\left\lfloor\frac{c-1}{2}\right\rfloor)&,c=2k,k\in Z\\
\end{split}\right.
\end{split}
$$

# 代码

```cpp
#include<cstdio>
#define int long long
using namespace std;
const int N=1000,P=9901;
int a,b;
int p[N],c[N],cnt;
void divd(int x){for(int i=2;i*i<=x;i++){if(x%i)continue;
		p[++cnt]=i;
		while(x%i==0)c[cnt]++,x/=i;
	}
	if(x>1)p[++cnt]=x,c[cnt]=1;
}
int ksm(int pi,int ci){
	int res=1;
	while(ci){if(ci&1)res=res*pi%P;
		pi=pi*pi%P,ci>>=1;
	}
	return res;
}
int f(int pi,int ci){if(ci==0)return 1;
	if(ci==1)return (pi+1)%P;
	if(ci%2)return f(pi,ci/2)*(1+ksm(pi,ci/2+1))%P;
	else return ((f(pi,ci/2-1)*(1+ksm(pi,ci/2))%P)*pi+1)%P;
}
signed main(){scanf("%lld%lld",&a,&b);
	divd(a);
	int ans=1;
	for(int i=1;i<=cnt;i++){ans=ans*f(p[i]%P,c[i]*b)%P;
	}
	printf("%lld",ans);
	return 0;
}
```

