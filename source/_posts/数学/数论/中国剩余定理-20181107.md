---
title: 中国剩余定理
categories:
  - 数学
mathjax: true
abbrlink: 8769
date: 2018-11-07 15:27:00
updated: 2018-11-07 15:27:00
---
# 内容

对于以下的一元线性同余方程组
$$
\left\{\begin{matrix}
x \equiv a_1(\bmod m_1)\\
x \equiv a_2(\bmod m_2)\\
\vdots \\
x \equiv a_n(\bmod m_n)\\
\end{matrix}\right.
$$

<!--more-->

若`gcd(m1,m2.,..,mn)==1`,则对于任意a1,a2,...,an,方程组有解.
$$
M=\prod^n_{i=1}m_i,M_i=\frac{M}{n_i}.\\
gcd(M_i,m_i)=1,M_i\cdot M_i^{-1}\equiv 1(\bmod m_i)\\
x=\sum^n_{i=1}a_iM_i^{-1}M_i.
$$

# 代码模板（弱化版）

洛谷p1495（满足$a_i$互质）

```cpp
#include<cstdio>
#define int long long
#define FOR(a,b,c) for(int a=b;a<=c;a++)
using namespace std;
int n,a[20],b[20],M=1;
int sum;
int exgcd(int a,int b,int& x,int& y){
	if(b==0)return x=1,y=0,a;
	int t=exgcd(b,a%b,y,x);
	return y=y-x*(a/b),t;
}
signed main(){
	scanf("%lld",&n);
	FOR(i,1,n)scanf("%lld%lld",&a[i],&b[i]),M*=a[i];
	FOR(i,1,n){
		int t=M/a[i];
		int x,y;
		exgcd(t,a[i],x,y);
		sum=(sum+x*t*b[i])%M;
	}
	printf("%lld",(sum%M+M)%M);
	return 0;
}
```

