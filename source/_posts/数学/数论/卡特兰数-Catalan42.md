---
title: 卡特兰数-Catalan
categories:
  - 数学
mathjax: true
abbrlink: 20810
date: 2018-12-21 13:16:00
updated: 2018-12-21 13:16:00
---
# 简介

卡特兰数又称卡塔兰数，英文名Catalan number，是组合数学中一个常出现在各种计数问题中出现的数列。以比利时的数学家欧仁·查理·卡塔兰 (1814–1894)的名字来命名。

<!--more-->

# 计算

$$
\begin{split}
&T_0=T_1=1\\
&T_n=\sum_{i=1}^{n}T_{i-1}T_{n-i}=\frac{4n-2}{n+1}\cdot T_{n-1}\\
&=\binom{2n}{n}-\binom{2n}{n-1}=\frac{\binom{2n}{n}}{n+1}
\end{split}.
$$

# 出栈次序

> 问$1\sim n$按序进栈，随意出栈，则出栈序列有多少种？（LuoguP1044）

计数类的问题一般要抽象出一定的数学模型

定义$f[n]$表示$1-n$按序进栈，随意出栈，出栈序列的种数

那么我们考虑最后一个出栈的元素$k$：

- 在$k$进栈以前，$1\sim k-1$显然要全部出栈，方案数为$f[k-1]$.
- 在$k$出栈以前，$k+1\sim n$显然要全部出栈，方案数为$f[n-k]$.

则根据乘法原理，以$k$结尾的出栈序列的方案数为$f[k-1]\times f[n-k]$.

而$k$可以取$1\sim n$，于是总方案数为
$$
\sum_{k=1}^nf[k-1]\times f[n-k]
$$
显然就是卡特兰数的模型，则公式计算即可

# 凸多边形三角划分

因为凸多边形的任意一条边必定属于某一个三角形，所以我们以某一条边为基准，以这条边的两个顶点为起点P1和终点Pn(P即Point)，将该凸多边形的顶点依序标记为P1、P2、……、Pn，再在该凸多边形中找任意一个不属于这两个点的顶点Pk(2<=k<=n-1)，来构成一个三角形，用这个三角形把一个凸多边形划分成两个凸多边形，其中一个凸多边形，是由P1，P2，……，Pk构成的凸k边形（顶点数即是边数），另一个凸多边形，是由Pk，Pk+1，……，Pn构成的凸n-k+1边形。

此时，我们若把Pk视为确定一点，那么根据**乘法原理**，f(n)的问题就等价于——凸k多边形的划分方案数乘以凸n-k+1多边形的划分方案数，即**选择Pk这个顶点的方案数f(n)=f(k)\*f(n-k+1)**。而k可以选2到n-1，所以再根据加法原理，将k取不同值的划分方案相加，得到的总方案数为：**f(n)=f(2)\*f(n-2+1)+f(3)\*f(n-3+1)+…+f(n-1)\*f(2)**。

看到此处，再看看卡特兰数的递推式，答案不言而喻。

最后，令f(2)=1，f(3)=1。

# 组成二叉搜索树

给定n个节点，能构成多少种不同的二叉搜索树?

令**f(k)表示1-k个结点构成的二叉搜索树的个数**。
则可令1-k中的任意结点m作为根结点，于是有：

**f(k)=sum{f(m-1)\*f(k-m-1):1<=m<=k}**

即为卡特兰数

# n对括号正确匹配数目

给定n对括号，求括号正确配对的字符串数，例如：
- 0对括号：[空序列] 1种可能
- 1对括号：() 1种可能
- 2对括号：()(),(()) 2种可能
- 3对括号：((())),()(()),()()(),(())(),(()()) 5种可能

那么n对括号有多少种正确配对的可能?