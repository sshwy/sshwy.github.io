---
title: 原根与模算术
mathjax: true
categories:
  - 数学
abbrlink: 13380
date: 2019-06-08 21:00:21
updated: 2019-06-08 21:00:21
tags:
keywords:
---

**摘要**

啃课件的时侯遇到的数论题，于是来填坑

<!--more-->

# 阶与原根

如果 (a,m)=1，记 x 为最小的正整数使得 $a^x\equiv 1\bmod m$. 那么 x 称为 $a\bmod m$ 的阶。记为 $x=ord_ma$。

可以把阶理解为模意义下 1 的最小次方根。

如果 $g\bmod m$ 的阶是 $\varphi(m)$，那么 $g$ 是 $\bmod m$ 的原根

即原根为模意义下 1 的 $\varphi$ 次方根，且保证没有更小的次方。

# 相关定理结论

根据欧拉定理，$a^{\varphi(m)}\equiv 1\mod m$。因此 $x|\varphi(m)$。

$a^i\equiv a^j\mod m$ 当且仅当 $i\equiv j\mod ord_ma$。

$\bmod m$ 有原根的充要条件是 $m=2,4,p^n,2p^n$，其中 $p$ 是奇素数，$n$ 是任意正整数

$\bmod m$ 有原根时，它有 $\varphi(\varphi(m))$ 个原根

# 素数的原根

结论：每个素数都有原根。

如果 p 是一个奇素数且有原根 r，那么 r 或者 r+p 是模 $p^2$ 的一个原根。

对于任意正整数 k，$p^k$ 都存在原根。如果 r 是模 $p^2$ 的原根，那么它也是模 $p^k$ 的原根。

# 离散对数和指数

在模 m 意义下（m 有原根 r）

使得 $r^x\equiv a\bmod m,1\leq x\leq \varphi(m)$ 的唯一整数 x 称为 a 模 m 以 r 为底的指数，记为 $x=\operatorname{ind}_ra$。这里不标明 m 是因为我们假定在计算过程中，m 恒定不变。

其实相当于把 $\log$ 改写成 $\operatorname{ind}$ 而已。不同的是，这个底数只能取原根。

离散对数和对数的性质很相似。设 a,b 与 m 互质，在模 $\varphi(m)$ 意义下：

1. $\operatorname{ind}_r1\equiv 0$.
2. $\operatorname{ind}_r(ab)\equiv \operatorname{ind}_ra+\operatorname{ind}_rb$.
3. $\operatorname{ind}_ra^k\equiv k\cdot \operatorname{ind}_ra$.

# 同余方程与离散对数

根据相关定理结论的第二条，同余方程与离散对数方程是可以转换的。一般地说，对于同余方程 $f(x)\equiv A\bmod m$，m 有原根 r 时，可以先取离散对数，转化为 $\operatorname{ind}_rf(x)\equiv \operatorname{ind}_rA\mod \varphi(m)$ 求解。求解了 $\operatorname{ind}_rx$ 的所有值后再计算指数 $r^{ind_rx}\bmod m$ 即可得到所有 x 的解。

> 求同余方程 $6x^{12}\equiv 11\bmod 17$ 的解

先转化为离散对数。已知 3 是 17 的一个原根，对数表如下

| a    | $ind_3a$ | a    | $ind_3a$ | a    | $ind_3a$ | a    | $ind_3a$ |
| ---- | -------- | ---- | -------- | ---- | -------- | ---- | -------- |
| 1    | 16       | 5    | 5        | 9    | 2        | 13   | 4        |
| 2    | 14       | 6    | 15       | 10   | 3        | 14   | 9        |
| 3    | 1        | 7    | 11       | 11   | 7        | 15   | 6        |
| 4    | 12       | 8    | 10       | 12   | 13       | 16   | 8        |

方程转化为
$$
\begin{split}
\operatorname{ind}_3(6x^{12})&\equiv \operatorname{ind}_311\mod \varphi(17)\\
\operatorname{ind}_36+\operatorname{ind}_3x^{12}&\equiv 7 \mod 16\\
12\cdot \operatorname{ind}_3x&\equiv 8 \mod 16\\
\operatorname{ind}_3x&\equiv 2 \mod 4\\
\end{split}
$$
可得 $\operatorname{ind}_3x\equiv 2,6,10,14\mod 16$.

则 $x\equiv 3^2,3^6,3^{10},3^{14}\mod 17$，即 $x\equiv 9,15,8,2\mod 17$.

