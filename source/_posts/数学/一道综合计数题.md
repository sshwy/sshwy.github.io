---
title: Tewelvefold way
mathjax: true
categories:
  - 数学
abbrlink: 40591
date: 2019-07-20 18:44:46
updated: 2019-07-20 18:44:46
tags:
keywords:
---

**摘要**

今天我们来探讨一道综合计数题。

<!--more-->

# 问题描述

> n个有标号/无标号的球分给m个有标号/无标号的盒子，盒子有三种限制：
>
> A. 无限制
> B. 每个盒子至少有一个球
> C. 每个盒子至多一个球
>
> 共12种问题。问方案数。（所有球都要放）

为了方便，将有标号的记为L（labelled），无标号的记为U（unlabelled）。一个问题可以缩写为3个字母。

# Section 1

## LLA

n个有标号的球分给m个有标号的盒子，无限制。那么每一个球有$m$种选择，于是总方案数是
$$
m^n
$$

## LLB

n个有标号的球分给m个有标号的盒子，每个盒子至少一个球。考虑容斥，全集大小$|U|=m^n$，问题转化为至少一个盒子没有球的方案数。
$$
\begin{split}
\sum_{i}m^{n-1}-\sum_{i,j}m^{n-2}+\cdots\\
=\sum_{i=1}^m\binom{m}{i}m^{n-i}(-1)^{i-1}
\end{split}
$$
于是$|U|$减掉容斥的部分得到
$$
Ans=\sum_{i=0}^m(-1)^i\binom{m}{i}m^{n-i}
$$

## LLC

n个有标号的球分给m个有标号的盒子，每个盒子至多一个球。

显然当$n>m$时无解，否则答案为排列
$$
A_m^n=\frac{m!}{(m-n)!}
$$

# Section 2

## ULA

n个无标号的球分给m个有标号的盒子，无限制。这可以看作一个不定方程非负整数解的个数的问题。使用插板法，答案为
$$
\binom{n+m-1}{m-1}=\binom{n+m-1}{n}
$$

## ULB

n个无标号的球分给m个有标号的盒子，每个盒子至少一个球。等价于方程正整数解的个数。答案即为
$$
\binom{n-1}{m-1}
$$

## ULC

n个无标号的球分给m个有标号的盒子，每个盒子至多一个球。

组合数问题，如果$n>m$则无解，否则答案为$\binom{m}{n}$。

# Section 3

## LUA

n个有标号的球分给m个无标号的盒子，无限制。那么我们枚举有几个盒子是非空的，转化为LUB。答案为
$$
\sum_{i=0}^m\begin{Bmatrix}n\\i\end{Bmatrix}
$$


## LUB

n个有标号的球分给m个无标号的盒子，每个盒子至少一个球。这样就是把一个大小为$n$的集合分成$m$个非空子集的方案数，即第二类斯特林数
$$
\begin{Bmatrix}n\\k
\end{Bmatrix}
$$


## LUC

n个有标号的球分给m个无标号的盒子，每个盒子至多一个球。

如果$n>m$无解，否则你就放。答案为$[n\le m]$。

# Section 4

## UUA

n个无标号的球分给m个无标号的盒子，无限制。

枚举有几个非空盒子，转化为UUB，答案为
$$
\sum_{i=1}^mP(n,i)
$$

## UUB

n个无标号的球分给m个无标号的盒子，每个盒子至少一个球。

即把$n$划分为m个部分的方案数，即拆分数$P(n,m)$。

## UUC

n个无标号的球分给m个无标号的盒子，每个盒子至多一个球。

答案即为$[n\le m]$。