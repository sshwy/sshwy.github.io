---
title: 图论概览
categories:
  - 图论
tags:
 - ZROI
 - 图论
abbrlink: 51508
author: sshwy
mathjax: true
date: 2018-10-04 08:41:00
updated: 2019-4-28 08:41:00
---
**摘要**

图 $G$ 是一个二元组 $(V,E)$。

其中 $V$ 称为顶点集，$E$ 称为边集，它们亦可写成 $V(G)$ 和 $E(G)$。

$E$ 的元素是一个二元组数对，用 $(x,y)$ 表示，其中 $x,y\in V$。

<!--more-->

------

# 分类

图含有多个分类的标签：
1. 有向 / 无向（Directed/Undirected）
2. 有环 / 无环（Ring/Acyclic）
3. 连通 / 非连通（Unicom/Non-Unicom）
4. 简单 / 多重（Simple/Multiple）
5. 加权（Weighted）

常见图结构：
1. 有向无环图（Directed Acyclic Graph，DAG）
2. 树（Tree）
3. 简单图（Simple Graph，不包含重边和自环）
4. 多重图（Multi-Graph，可能包含重边和自环）
5. 加权图（Weighted Graph，通常指边带权）


# 图的存储

图的存储大体分邻接矩阵，邻接表，链式前向星三种。

| 方式       | 存储              | 空间复杂度 | 边的存在性判断 | 边的遍历 |
| ---------- | ----------------- | ---------- | -------------- | -------- |
| 邻接矩阵   | 二维数组          | $O(v^2)$   | $O(1)$         | $O(v^2)$ |
| 邻接表     | vector 或二维数组 | $O(v+e)$   | $O(e)$         | $O(e)$   |
| 链式前向星 | 结构体            | $O(e)$     | $O(e)$         | $O(e)$   |

# 玄学的度

## 度
- **无向图**中，定义 $dg()$ 表示结点的**度**，则 $\forall v \in V(G)$ ,
$$dg(v)=\sum_{u \in V(G)}[\ ((u,v)\in E(G))\vee((v,u)\in E(G))\ ]$$

- **有向图**的结点分入度（$idg()$）和出度（$odg()$）： $\forall v \in V(G)$ ,
$$idg(v)=\sum_{u\in V(G)}[(u,v)\in E(G)] \\ odg(v)=\sum_{u\in V(G)}[(v,u)\in E(G)] $$

## 度序列 -Sequence Degree

### 度序列 - 形式化定义

- 对于 $V(G)=\left \{v_1,v_2,\cdots ,v_p \right \}$ ，则称**非负整数**序列 $\left \{dg(v_1),dg(v_2),\cdots ,dg(v_p) \right \}$ 为图 G 的**度序列**.
- **简单图**的度序列称为**图序列**.

### 前置定理

$$
\forall G=(V,E),\sum_{v\in V}d(v)=2|V(G)|
$$

推论 1：任何图中，奇度点的个数为偶数。

推论 2：**非负整数序列** $A=\left \{a_1,{a_2},\cdots,a_p \right \}$ 是某个图的**度序列**, 当且仅当 $\sum_{i=1}^na_i$ 是偶数。

### Erdos-Gallai 定理
序列 $A$ 是**图序列**当且仅当：
1. $A$ 是度序列（见**前置定理 - 推论 2**）
2. $p-1\geq a_1\geq a_2\geq \cdots \geq a_p$.
3. $\forall k\in[1,p-1],\sum_{i=1}^ka_i\leq\sum_{i=k+1}^pmin(k,a_i)+k(k-1)$

## 序列可图性

### 可图（化）- 定义
一个序列是某个无向图的**度序列**，则该序列是可图的，也称该序列**可图化**。进一步，一个序列是某个无向图的**图序列**，称该序列可**简单图化**。

### Havel-Hakimi 定理
对于**非递增**序列 $A=\left \{a_1,{a_2},\cdots,a_p \right \}$

$A$ 可简单图化，当且仅当：
$$
A'=\left\{a_2-1,a_3-1,\cdots,a_{a_1+1}-1,a_{a_1+2},a_{a_1+3},\cdots,a_n \right\}
$$
可简单图化。

#### 分析 & 简略的感性证明
先分析 $A'$ 的结构：
- 一共有 $n-1$ 个元素，比 $A$ 少了一个 $a_1$
- 前 $a_1$ 个数都减了 1，后面有 $n-a_1-1$ 个数不变。

从序列 $A$ 中产生 $A'$，相当于将 $A$ 对应的无向图中度为 $a_1$ 的点删除（并且把与这个点连接的边也删掉），这样相当于删除了元素 $a_1$ ，又让其他的 $a_1$ 个元素的度分别减 1（之所以是 $a_2$~$a_{a_1+1}$ 的度减 1，因为这是构造出来的）.

如果这么理解的话，那么 $A'$ 可简单图化，则把 $a_1$ 补回去，就是 $A$ 对应的无向图——显然也是简单图。 $Q.E.D$

#### 定理的使用
> 本文来自 YY-Captain 的 CSDN 博客 ，[全文地址](https://blog.csdn.net/makenothing/article/details/41308903?utm_source=copy)
判断序列 $A=\{6,5,4,3,3,3,2,0\}$ 是否可图。
按照定理一个个删点；如果 $A$ 出现了负度，则 $A$ 不可简单图

1. 删除首元素 6，将后面的 6 个元素减一，得到：$A_1=\{4,3,2,2,2,1,0\}$
2. 删除首元素 4，将后面的 4 个元素减一，得到：$A_2=\{2,1,1,1,1,0\}$
3. 删除首元素 2，将后面的 2 个元素减一，得到：$A_3=\{0,0,1,1,0\}$
4. 重新排序：$A_4=\{1,1,0,0,0\}$
5. 删除首元素 1，将后面的 1 个元素减一，得到：$A_5=\{0,0,0,0\}$

则最后得到的是非负序列，所以序列 $A$ 可简单图化。

> 判断序列 $A=\{7,6,4,3,3,3,2,1\}$ 是否可图。
1. 删除首元素 7，将后面的 7 个元素减一，得到：$A_1=\{6,3,2,2,2,1,0\}$
2. 删除首元素 6，将后面的 6 个元素减一，得到：$A_2=\{2,1,1,1,0,-1\}$

最后得到的是存在负数的序列，所以序列 $A$ 不可简单图化！

# 图的遍历

## BFS-CF1037D
判断序列是否为 BFS 遍历

同一深度的点在序列中应是连续的，且这连续的子段用到的数的排列顺序等价

直接模拟即可

## DFS 生成树
- 见 [Tarjan 之有向图 SCC](https://sshwy.github.io/2018/10/01/59112/)

### HDU5215
先 DFS 搜索，通过返祖边确定简单环，通过深度差确定环的奇偶性。

对于相交的环，因为只用判断奇偶性，所以分别考虑两者即可

任意两条返祖边相交，都会产生偶环

### CF295E

## 欧拉回路
欧拉回路作为图的子图，满足：（充要条件）
- 无向图：每个点的度数为偶数
- 有向图：每个点的入度 = 出度

链表 +DFS 求欧拉回路

# 图的生成树
定义：图的生成树是它的一颗**含有其所有顶点**的**无环**连通子图。
## 最小生成树 -MST
加权图 G 中，边权和最小的生成树。

### Kruskal 算法
利用贪心的思想，每次选择权值最小的（且两个端点没有同时在 MST 中，否则就不是树了）边，加入到 MST 的边集中。排序实现贪心，[并查集](/2018/10/01/64483/) 实现验证可用性。

复杂度 $O(Elog_2E+E)$

### Prim 算法
仍然是贪心，不过改成每次往 MST 中加点（距离 MST 最小的那个点）

堆实现贪心，复杂度 $O(Vlog_2V+Elog_2V)$

斐波那契堆实现贪心，复杂度 $O(VlogV+E)$

## 最小瓶颈生成树
加权图 G 中，最大边权值最小的生成树。最小生成树是最小瓶颈生成树，因此可通过求 MST 求得最小瓶颈生成树。或着二分边权，判定图是否连通：

- 对于二分的边权 $mid$，如果图连通，则继续考虑 $\leq mid$ 的边
- 否则，把连通的分量缩点，考虑剩下的 $\geq mid$ 的边
- 期望复杂度 $O(E)$.


## 生成树计数
Cayley 定理：完全图的生成树个数为 $n^{n-2}$

如果每个点的度数为 $d_i$，那么生成树个数为 $\frac{(n-2)!}{(d_1-1)!(d_2-1)!\cdots (d_n-1)!}$

每个连通块大小为 $a_i$，那么添加一些边将这些连通块连通的生成树个数为 $a_1a_2...a_n(a_1+a_2+\cdots +a_n)^{n-2}$。

# 最短路
[最短路算法 ·ShortestPath](/2018/10/03/726/)

# 特殊子图
## 前置概念
1. 偏心距：$ecc(v)=\max_{(u,v)\in E} w(u,v)$
2. 直径：$d=\max_{v\in V}ecc(v)$
3. 半径：$r=\min_{v\in V}ecc(v)$
4. 中心：半径对应的 $v$
5. 绝对中心：可以是边上的点（把边分成两部分）

## 最小直径生成树
**绝对**中心的**最短路生成树**。

如何证明？

**对绝对中心来说**，一棵树 $T$ 有直径为半径的两倍。如果最小直径生成树 $T’$ 不包含绝对中心，那么取 $T’$ 的绝对中心 $v$，显然矛盾。

# 拓扑排序
每次去掉图中入度为 0 的点，时间复杂度 O(n+m)。

如果最后不为空集那么这个图不为 DAG，每个点入度不为 0，即每个点可以选择一个前趋，沿着前趋走根据抽屉原理一定能找到相同点，也就是一个环。

## 字典序最小的拓扑序
- 堆拓扑即可。

## 拓扑序变种
[HNOI2015 菜肴制作](/2018/10/01/27017/)

# 连通分量

[Tarjan 之有向图 SCC](/2018/10/01/59112/)
[Tarjan 算法之无向图](/2018/10/01/23395/)